-- Brainrot Duplicator Panel for Roblox
-- Full UI in Lua with working backend

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

-- Services from game
local Net = require(ReplicatedStorage.Packages.Net)
local Synchronizer = require(ReplicatedStorage.Packages.Synchronizer)

-- Configuration
local Config = {
    SourceSlot = 1,
    DestSlots = {2, 3, 4, 5},
    Delay = 0.1,
    Method = "Race",
    AutoRetry = true,
    AntiDetect = true,
    AutoSell = false,
    OnlyMutations = false,
    IsRunning = false
}

-- Stats
local Stats = {
    TotalSteals = 0,
    SuccessfulDups = 0,
    FailedDups = 0,
    StartTime = tick()
}

-- Remote Events
local Remotes = {
    PlotOpen = Net:RemoteEvent("PlotService/Open"),
    PlotSell = Net:RemoteEvent("PlotService/Sell"),
    StealGrab = Net:RemoteEvent("StealService/Grab"),
    ClaimCoins = Net:RemoteEvent("PlotService/ClaimCoins"),
    Hidden1 = Net:RemoteEvent("5aa39ea1-0c65-4fcf-aff9-b18a7ef277c3"),
    Hidden2 = Net:RemoteEvent("5c8f0dd0-0f9e-44ba-8f9b-197958b661ab"),
}

-- Functions
local function GetPlotChannel()
    return Synchronizer:Wait(LocalPlayer.Name)
end

local function GetAnimalList()
    local channel = GetPlotChannel()
    if channel then
        return channel:Get("AnimalList") or {}
    end
    return {}
end

local function GetAnimalData(slot)
    local animalList = GetAnimalList()
    return animalList[slot]
end

-- Create UI
local function CreateUI()
    -- Remove existing
    if PlayerGui:FindFirstChild("BrainrotPanel") then
        PlayerGui.BrainrotPanel:Destroy()
    end

    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "BrainrotPanel"
    ScreenGui.ResetOnSpawn = false
    ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    ScreenGui.Parent = PlayerGui

    -- Main Frame
    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainFrame"
    MainFrame.Size = UDim2.new(0, 700, 0, 600)
    MainFrame.Position = UDim2.new(0.5, -350, 0.5, -300)
    MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 31)
    MainFrame.BorderSizePixel = 0
    MainFrame.Parent = ScreenGui

    local MainCorner = Instance.new("UICorner")
    MainCorner.CornerRadius = UDim.new(0, 12)
    MainCorner.Parent = MainFrame

    local MainStroke = Instance.new("UIStroke")
    MainStroke.Color = Color3.fromRGB(138, 43, 226)
    MainStroke.Thickness = 2
    MainStroke.Parent = MainFrame

    -- Header
    local Header = Instance.new("Frame")
    Header.Name = "Header"
    Header.Size = UDim2.new(1, 0, 0, 50)
    Header.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
    Header.BorderSizePixel = 0
    Header.Parent = MainFrame

    local HeaderCorner = Instance.new("UICorner")
    HeaderCorner.CornerRadius = UDim.new(0, 12)
    HeaderCorner.Parent = Header

    local HeaderFix = Instance.new("Frame")
    HeaderFix.Size = UDim2.new(1, 0, 0, 12)
    HeaderFix.Position = UDim2.new(0, 0, 1, -12)
    HeaderFix.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
    HeaderFix.BorderSizePixel = 0
    HeaderFix.Parent = Header

    -- Title
    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(1, -100, 1, 0)
    Title.Position = UDim2.new(0, 15, 0, 0)
    Title.BackgroundTransparency = 1
    Title.Text = "üß† BRAINROT DUPLICATOR"
    Title.TextColor3 = Color3.new(1, 1, 1)
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 18
    Title.TextXAlignment = Enum.TextXAlignment.Left
    Title.Parent = Header

    -- Status
    local Status = Instance.new("TextLabel")
    Status.Size = UDim2.new(0, 80, 1, 0)
    Status.Position = UDim2.new(1, -170, 0, 0)
    Status.BackgroundTransparency = 1
    Status.Text = "‚óè READY"
    Status.TextColor3 = Color3.fromRGB(0, 255, 0)
    Status.Font = Enum.Font.GothamBold
    Status.TextSize = 12
    Status.Parent = Header

    -- Close Button
    local CloseButton = Instance.new("TextButton")
    CloseButton.Name = "CloseButton"
    CloseButton.Size = UDim2.new(0, 40, 0, 40)
    CloseButton.Position = UDim2.new(1, -45, 0, 5)
    CloseButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
    CloseButton.Text = "√ó"
    CloseButton.TextColor3 = Color3.new(1, 1, 1)
    CloseButton.Font = Enum.Font.GothamBold
    CloseButton.TextSize = 24
    CloseButton.Parent = Header

    local CloseCorner = Instance.new("UICorner")
    CloseCorner.CornerRadius = UDim.new(0, 8)
    CloseCorner.Parent = CloseButton

    -- Minimize Button
    local MinimizeButton = Instance.new("TextButton")
    MinimizeButton.Name = "MinimizeButton"
    MinimizeButton.Size = UDim2.new(0, 40, 0, 40)
    MinimizeButton.Position = UDim2.new(1, -90, 0, 5)
    MinimizeButton.BackgroundColor3 = Color3.fromRGB(255, 152, 0)
    MinimizeButton.Text = "‚àí"
    MinimizeButton.TextColor3 = Color3.new(1, 1, 1)
    MinimizeButton.Font = Enum.Font.GothamBold
    MinimizeButton.TextSize = 24
    MinimizeButton.Parent = Header

    local MinCorner = Instance.new("UICorner")
    MinCorner.CornerRadius = UDim.new(0, 8)
    MinCorner.Parent = MinimizeButton

    -- Tabs Container
    local TabsContainer = Instance.new("Frame")
    TabsContainer.Name = "TabsContainer"
    TabsContainer.Size = UDim2.new(1, 0, 0, 40)
    TabsContainer.Position = UDim2.new(0, 0, 0, 50)
    TabsContainer.BackgroundColor3 = Color3.fromRGB(26, 26, 37)
    TabsContainer.BorderSizePixel = 0
    TabsContainer.Parent = MainFrame

    local TabsLayout = Instance.new("UIListLayout")
    TabsLayout.FillDirection = Enum.FillDirection.Horizontal
    TabsLayout.Padding = UDim.new(0, 0)
    TabsLayout.Parent = TabsContainer

    -- Content Container
    local ContentContainer = Instance.new("ScrollingFrame")
    ContentContainer.Name = "ContentContainer"
    ContentContainer.Size = UDim2.new(1, -20, 1, -110)
    ContentContainer.Position = UDim2.new(0, 10, 0, 100)
    ContentContainer.BackgroundTransparency = 1
    ContentContainer.ScrollBarThickness = 6
    ContentContainer.ScrollBarImageColor3 = Color3.fromRGB(138, 43, 226)
    ContentContainer.BorderSizePixel = 0
    ContentContainer.Parent = MainFrame

    local ContentLayout = Instance.new("UIListLayout")
    ContentLayout.Padding = UDim.new(0, 10)
    ContentLayout.SortOrder = Enum.SortOrder.LayoutOrder
    ContentLayout.Parent = ContentContainer

    -- Console Frame
    local ConsoleFrame = Instance.new("Frame")
    ConsoleFrame.Name = "ConsoleFrame"
    ConsoleFrame.Size = UDim2.new(1, 0, 0, 250)
    ConsoleFrame.BackgroundColor3 = Color3.fromRGB(26, 26, 37)
    ConsoleFrame.BorderSizePixel = 0
    ConsoleFrame.LayoutOrder = 1
    ConsoleFrame.Parent = ContentContainer

    local ConsoleCorner = Instance.new("UICorner")
    ConsoleCorner.CornerRadius = UDim.new(0, 8)
    ConsoleCorner.Parent = ConsoleFrame

    local ConsolePadding = Instance.new("UIPadding")
    ConsolePadding.PaddingTop = UDim.new(0, 10)
    ConsolePadding.PaddingBottom = UDim.new(0, 10)
    ConsolePadding.PaddingLeft = UDim.new(0, 10)
    ConsolePadding.PaddingRight = UDim.new(0, 10)
    ConsolePadding.Parent = ConsoleFrame

    local ConsoleTitle = Instance.new("TextLabel")
    ConsoleTitle.Size = UDim2.new(1, 0, 0, 20)
    ConsoleTitle.BackgroundTransparency = 1
    ConsoleTitle.Text = "üìü CONSOLE"
    ConsoleTitle.TextColor3 = Color3.fromRGB(138, 43, 226)
    ConsoleTitle.Font = Enum.Font.GothamBold
    ConsoleTitle.TextSize = 14
    ConsoleTitle.TextXAlignment = Enum.TextXAlignment.Left
    ConsoleTitle.Parent = ConsoleFrame

    local Console = Instance.new("ScrollingFrame")
    Console.Name = "Console"
    Console.Size = UDim2.new(1, 0, 1, -30)
    Console.Position = UDim2.new(0, 0, 0, 30)
    Console.BackgroundColor3 = Color3.fromRGB(13, 13, 21)
    Console.ScrollBarThickness = 4
    Console.BorderSizePixel = 0
    Console.Parent = ConsoleFrame

    local ConsoleScrollCorner = Instance.new("UICorner")
    ConsoleScrollCorner.CornerRadius = UDim.new(0, 6)
    ConsoleScrollCorner.Parent = Console

    local ConsoleLayout = Instance.new("UIListLayout")
    ConsoleLayout.Padding = UDim.new(0, 2)
    ConsoleLayout.Parent = Console

    local ConsolePadding2 = Instance.new("UIPadding")
    ConsolePadding2.PaddingTop = UDim.new(0, 5)
    ConsolePadding2.PaddingLeft = UDim.new(0, 8)
    ConsolePadding2.PaddingRight = UDim.new(0, 8)
    ConsolePadding2.Parent = Console

    -- Controls Frame
    local ControlsFrame = Instance.new("Frame")
    ControlsFrame.Name = "ControlsFrame"
    ControlsFrame.Size = UDim2.new(1, 0, 0, 300)
    ControlsFrame.BackgroundColor3 = Color3.fromRGB(26, 26, 37)
    ControlsFrame.BorderSizePixel = 0
    ControlsFrame.LayoutOrder = 2
    ControlsFrame.Parent = ContentContainer

    local ControlsCorner = Instance.new("UICorner")
    ControlsCorner.CornerRadius = UDim.new(0, 8)
    ControlsCorner.Parent = ControlsFrame

    local ControlsPadding = Instance.new("UIPadding")
    ControlsPadding.PaddingTop = UDim.new(0, 15)
    ControlsPadding.PaddingBottom = UDim.new(0, 15)
    ControlsPadding.PaddingLeft = UDim.new(0, 15)
    ControlsPadding.PaddingRight = UDim.new(0, 15)
    ControlsPadding.Parent = ControlsFrame

    local ControlsLayout = Instance.new("UIListLayout")
    ControlsLayout.Padding = UDim.new(0, 10)
    ControlsLayout.Parent = ControlsFrame

    local ControlsTitle = Instance.new("TextLabel")
    ControlsTitle.Size = UDim2.new(1, 0, 0, 20)
    ControlsTitle.BackgroundTransparency = 1
    ControlsTitle.Text = "üéÆ CONTROLS"
    ControlsTitle.TextColor3 = Color3.fromRGB(138, 43, 226)
    ControlsTitle.Font = Enum.Font.GothamBold
    ControlsTitle.TextSize = 14
    ControlsTitle.TextXAlignment = Enum.TextXAlignment.Left
    ControlsTitle.Parent = ControlsFrame

    -- Source Slot Input
    local SourceLabel = Instance.new("TextLabel")
    SourceLabel.Size = UDim2.new(1, 0, 0, 20)
    SourceLabel.BackgroundTransparency = 1
    SourceLabel.Text = "Source Slot:"
    SourceLabel.TextColor3 = Color3.fromRGB(170, 170, 170)
    SourceLabel.Font = Enum.Font.Gotham
    SourceLabel.TextSize = 12
    SourceLabel.TextXAlignment = Enum.TextXAlignment.Left
    SourceLabel.Parent = ControlsFrame

    local SourceInput = Instance.new("TextBox")
    SourceInput.Name = "SourceInput"
    SourceInput.Size = UDim2.new(1, 0, 0, 35)
    SourceInput.BackgroundColor3 = Color3.fromRGB(13, 13, 21)
    SourceInput.Text = "1"
    SourceInput.TextColor3 = Color3.new(1, 1, 1)
    SourceInput.Font = Enum.Font.Gotham
    SourceInput.TextSize = 14
    SourceInput.PlaceholderText = "Enter slot number"
    SourceInput.Parent = ControlsFrame

    local SourceInputCorner = Instance.new("UICorner")
    SourceInputCorner.CornerRadius = UDim.new(0, 6)
    SourceInputCorner.Parent = SourceInput

    local SourceInputPadding = Instance.new("UIPadding")
    SourceInputPadding.PaddingLeft = UDim.new(0, 10)
    SourceInputPadding.Parent = SourceInput

    -- Slots Grid
    local SlotsLabel = Instance.new("TextLabel")
    SlotsLabel.Size = UDim2.new(1, 0, 0, 20)
    SlotsLabel.BackgroundTransparency = 1
    SlotsLabel.Text = "Destination Slots:"
    SlotsLabel.TextColor3 = Color3.fromRGB(170, 170, 170)
    SlotsLabel.Font = Enum.Font.Gotham
    SlotsLabel.TextSize = 12
    SlotsLabel.TextXAlignment = Enum.TextXAlignment.Left
    SlotsLabel.Parent = ControlsFrame

    local SlotsGrid = Instance.new("Frame")
    SlotsGrid.Name = "SlotsGrid"
    SlotsGrid.Size = UDim2.new(1, 0, 0, 70)
    SlotsGrid.BackgroundTransparency = 1
    SlotsGrid.Parent = ControlsFrame

    local SlotsGridLayout = Instance.new("UIGridLayout")
    SlotsGridLayout.CellSize = UDim2.new(0.23, 0, 0, 30)
    SlotsGridLayout.CellPadding = UDim2.new(0.02, 0, 0, 5)
    SlotsGridLayout.Parent = SlotsGrid

    -- Create slot buttons
    local SlotButtons = {}
    for i = 2, 9 do
        local SlotBtn = Instance.new("TextButton")
        SlotBtn.Name = "Slot"..i
        SlotBtn.Text = "Slot "..i
        SlotBtn.BackgroundColor3 = Color3.fromRGB(26, 26, 37)
        SlotBtn.TextColor3 = Color3.fromRGB(136, 136, 136)
        SlotBtn.Font = Enum.Font.GothamBold
        SlotBtn.TextSize = 12
        SlotBtn.Parent = SlotsGrid

        local SlotCorner = Instance.new("UICorner")
        SlotCorner.CornerRadius = UDim.new(0, 6)
        SlotCorner.Parent = SlotBtn

        local SlotStroke = Instance.new("UIStroke")
        SlotStroke.Color = Color3.fromRGB(42, 42, 53)
        SlotStroke.Thickness = 2
        SlotStroke.Parent = SlotBtn

        SlotButtons[i] = {Button = SlotBtn, Active = i <= 5}

        -- Toggle on/off
        if i <= 5 then
            SlotBtn.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
            SlotBtn.TextColor3 = Color3.new(1, 1, 1)
            SlotStroke.Color = Color3.fromRGB(138, 43, 226)
        end

        SlotBtn.MouseButton1Click:Connect(function()
            SlotButtons[i].Active = not SlotButtons[i].Active

            if SlotButtons[i].Active then
                SlotBtn.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
                SlotBtn.TextColor3 = Color3.new(1, 1, 1)
                SlotStroke.Color = Color3.fromRGB(138, 43, 226)
            else
                SlotBtn.BackgroundColor3 = Color3.fromRGB(26, 26, 37)
                SlotBtn.TextColor3 = Color3.fromRGB(136, 136, 136)
                SlotStroke.Color = Color3.fromRGB(42, 42, 53)
            end
        end)
    end

    -- Buttons Container
    local ButtonsContainer = Instance.new("Frame")
    ButtonsContainer.Size = UDim2.new(1, 0, 0, 45)
    ButtonsContainer.BackgroundTransparency = 1
    ButtonsContainer.Parent = ControlsFrame

    local ButtonsLayout = Instance.new("UIListLayout")
    ButtonsLayout.FillDirection = Enum.FillDirection.Horizontal
    ButtonsLayout.Padding = UDim.new(0, 10)
    ButtonsLayout.Parent = ButtonsContainer

    -- Function to create button
    local function CreateButton(name, text, color, parent)
        local btn = Instance.new("TextButton")
        btn.Name = name
        btn.Size = UDim2.new(0.23, 0, 1, 0)
        btn.BackgroundColor3 = color
        btn.Text = text
        btn.TextColor3 = Color3.new(1, 1, 1)
        btn.Font = Enum.Font.GothamBold
        btn.TextSize = 13
        btn.Parent = parent

        local btnCorner = Instance.new("UICorner")
        btnCorner.CornerRadius = UDim.new(0, 6)
        btnCorner.Parent = btn

        return btn
    end

    local GrabButton = CreateButton("GrabButton", "üéØ GRAB", Color3.fromRGB(138, 43, 226), ButtonsContainer)
    local StartButton = CreateButton("StartButton", "‚ñ∂Ô∏è START", Color3.fromRGB(76, 175, 80), ButtonsContainer)
    local ManualButton = CreateButton("ManualButton", "üîÑ MANUAL", Color3.fromRGB(255, 152, 0), ButtonsContainer)
    local StopButton = CreateButton("StopButton", "‚èπÔ∏è STOP", Color3.fromRGB(255, 68, 68), ButtonsContainer)

    -- Console logging function
    local function AddLog(message, logType)
        logType = logType or "info"
        
        local colors = {
            success = Color3.fromRGB(0, 255, 0),
            error = Color3.fromRGB(255, 0, 0),
            info = Color3.fromRGB(0, 191, 255),
            warning = Color3.fromRGB(255, 152, 0)
        }

        local time = os.date("%H:%M:%S")
        
        local LogEntry = Instance.new("TextLabel")
        LogEntry.Size = UDim2.new(1, 0, 0, 15)
        LogEntry.BackgroundTransparency = 1
        LogEntry.Text = string.format("[%s] %s", time, message)
        LogEntry.TextColor3 = colors[logType] or colors.info
        LogEntry.Font = Enum.Font.Code
        LogEntry.TextSize = 11
        LogEntry.TextXAlignment = Enum.TextXAlignment.Left
        LogEntry.Parent = Console

        ConsoleLayout:ApplyLayout()
        Console.CanvasSize = UDim2.new(0, 0, 0, ConsoleLayout.AbsoluteContentSize.Y)
        Console.CanvasPosition = Vector2.new(0, Console.CanvasSize.Y.Offset)
    end

    -- Duplication functions
    local function DuplicateViaSynchronizer(sourceSlot, destSlot)
        local channel = GetPlotChannel()
        if not channel then return false end
        
        local animalData = GetAnimalData(sourceSlot)
        if not animalData or type(animalData) ~= "table" then 
            return false 
        end
        
        local duplicatedAnimal = {
            Index = animalData.Index,
            Mutation = animalData.Mutation,
            Traits = animalData.Traits and table.clone(animalData.Traits) or nil,
            Timer = 0,
            LastCollect = workspace:GetServerTimeNow(),
            Steal = nil,
            Machine = nil,
            OfflineGain = nil
        }
        
        local success = pcall(function()
            channel:Set(("AnimalList.%d"):format(destSlot), duplicatedAnimal)
        end)
        
        return success
    end

    local function DuplicateViaRemoteSpam(sourceSlot, destSlot)
        local animalData = GetAnimalData(sourceSlot)
        if not animalData then return false end
        
        task.spawn(function()
            for i = 1, 5 do
                pcall(function()
                    Remotes.PlotOpen:FireServer(destSlot)
                end)
                task.wait(0.01)
            end
        end)
        
        task.spawn(function()
            pcall(function()
                Remotes.StealGrab:FireServer("Grab", sourceSlot)
                task.wait(0.05)
                Remotes.Hidden1:FireServer("Place", destSlot)
            end)
        end)
        
        return true
    end

    local function DuplicateAnimal(sourceSlot, destSlot)
        Stats.TotalSteals = Stats.TotalSteals + 1
        
        local success = false
        
        if Config.Method == "Race" then
            success = DuplicateViaRemoteSpam(sourceSlot, destSlot)
        elseif Config.Method == "Synchronizer" then
            success = DuplicateViaSynchronizer(sourceSlot, destSlot)
        end
        
        if success then
            Stats.SuccessfulDups = Stats.SuccessfulDups + 1
            AddLog(string.format("‚úì Duplicated to Slot %d", destSlot), "success")
        else
            Stats.FailedDups = Stats.FailedDups + 1
            AddLog(string.format("‚úó Failed to duplicate to Slot %d", destSlot), "error")
        end
        
        return success
    end

    -- Button handlers
    GrabButton.MouseButton1Click:Connect(function()
        AddLog("Grabbing animal from Slot "..Config.SourceSlot.."...", "info")
        
        task.spawn(function()
            local animalData = GetAnimalData(Config.SourceSlot)
            
            if not animalData then
                AddLog("No animal in source slot!", "error")
                return
            end
            
            pcall(function()
                Remotes.StealGrab:FireServer("Grab", Config.SourceSlot)
                task.wait(0.1)
                Remotes.Hidden2:FireServer(workspace:GetServerTimeNow() + 67, 
                    "c262398d-68e3-4499-8bea-99766bf11686", 
                    LocalPlayer.Name, 
                    Config.SourceSlot)
            end)
            
            AddLog("Grab command sent!", "success")
        end)
    end)

    StartButton.MouseButton1Click:Connect(function()
        if Config.IsRunning then return end
        
        Config.IsRunning = true
        StartButton.Text = "‚è∏Ô∏è RUNNING"
        StartButton.BackgroundColor3 = Color3.fromRGB(255, 152, 0)
        AddLog("Auto-duplication started!", "success")
        
        task.spawn(function()
            while Config.IsRunning do
                local sourceAnimal = GetAnimalData(Config.SourceSlot)
                
                if sourceAnimal and type(sourceAnimal) == "table" then
                    for _, destSlot in ipairs(Config.DestSlots) do
                        if Config.IsRunning then
                            local destAnimal = GetAnimalData(destSlot)
                            
                            if not destAnimal or destAnimal == "Empty" then
                                DuplicateAnimal(Config.SourceSlot, destSlot)
                                task.wait(Config.Delay)
                            end
                        end
                    end
                end
                
                task.wait(1)
            end
        end)
    end)

    ManualButton.MouseButton1Click:Connect(function()
        AddLog("Manual duplication started...", "info")
        
        task.spawn(function()
            local sourceAnimal = GetAnimalData(Config.SourceSlot)
            
            if not sourceAnimal then
                AddLog("No animal in source slot!", "error")
                return
            end
            
            for _, destSlot in ipairs(Config.DestSlots) do
                DuplicateAnimal(Config.SourceSlot, destSlot)
                task.wait(Config.Delay)
            end
            
            AddLog("Manual duplication complete!", "success")
        end)
    end)

    StopButton.MouseButton1Click:Connect(function()
        if not Config.IsRunning then return end
        
        Config.IsRunning = false
        StartButton.Text = "‚ñ∂Ô∏è START"
        StartButton.BackgroundColor3 = Color3.fromRGB(76, 175, 80)
        AddLog("Auto-duplication stopped!", "warning")
    end)

    -- Close/Minimize handlers
    CloseButton.MouseButton1Click:Connect(function()
        ScreenGui:Destroy()
        AddLog("Panel closed", "info")
    end)

    MinimizeButton.MouseButton1Click:Connect(function()
        MainFrame.Visible = false
        
        -- Create restore button
        local RestoreButton = Instance.new("TextButton")
        RestoreButton.Size = UDim2.new(0, 150, 0, 40)
        RestoreButton.Position = UDim2.new(1, -160, 0, 10)
        RestoreButton.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
        RestoreButton.Text = "üß† Restore Panel"
        RestoreButton.TextColor3 = Color3.new(1, 1, 1)
        RestoreButton.Font = Enum.Font.GothamBold
        RestoreButton.TextSize = 13
        RestoreButton.Parent = ScreenGui

        local RestoreCorner = Instance.new("UICorner")
        RestoreCorner.CornerRadius = UDim.new(0, 6)
        RestoreCorner.Parent = RestoreButton

        RestoreButton.MouseButton1Click:Connect(function()
            MainFrame.Visible = true
            RestoreButton:Destroy()
        end)
    end)

    -- Update Config from inputs
    SourceInput.FocusLost:Connect(function()
        local num = tonumber(SourceInput.Text)
        if num and num >= 1 and num <= 10 then
            Config.SourceSlot = num
            AddLog("Source slot set to "..num, "info")
        else
            SourceInput.Text = tostring(Config.SourceSlot)
            AddLog("Invalid slot number!", "error")
        end
    end)

    -- Update DestSlots from buttons
    local function UpdateDestSlots()
        Config.DestSlots = {}
        for i, data in pairs(SlotButtons) do
            if data.Active then
                table.insert(Config.DestSlots, i)
            end
        end
    end

    for i, data in pairs(SlotButtons) do
        data.Button.MouseButton1Click:Connect(UpdateDestSlots)
    end

    -- Make draggable
    local dragging = false
    local dragInput
    local dragStart
    local startPos

    local function update(input)
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
    end

    Header.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = MainFrame.Position

            input.Changed:Connect(function()
                if input.UserState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    Header.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            update(input)
        end
    end)

    -- Keyboard shortcuts
    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if gameProcessed then return end

        if input.KeyCode == Enum.KeyCode.F1 then
            MainFrame.Visible = not MainFrame.Visible
        elseif input.KeyCode == Enum.KeyCode.F2 then
            GrabButton.MouseButton1Click:Fire()
        elseif input.KeyCode == Enum.KeyCode.F3 then
            StopButton.MouseButton1Click:Fire()
        elseif input.KeyCode == Enum.KeyCode.F4 then
            ManualButton.MouseButton1Click:Fire()
        end
    end)

    -- Auto-resize content
    ContentLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        ContentContainer.CanvasSize = UDim2.new(0, 0, 0, ContentLayout.AbsoluteContentSize.Y + 20)
    end)

    -- Initial logs
    AddLog("üß† Brainrot Duplicator v2.0 initialized", "success")
    AddLog("Press F1 to toggle, F2 to grab, F3 to stop, F4 for manual dup", "info")
    AddLog("Ready to duplicate!", "success")

    return ScreenGui, {
        AddLog = AddLog,
        MainFrame = MainFrame,
        Console = Console,
        Status = Status
    }
end

-- Create the UI
local GUI, Components = CreateUI()

-- Status updater
task.spawn(function()
    while task.wait(0.5) do
        if Config.IsRunning then
            Components.Status.Text = "‚óè RUNNING"
            Components.Status.TextColor3 = Color3.fromRGB(0, 255, 0)
        else
            Components.Status.Text = "‚óè READY"
            Components.Status.TextColor3 = Color3.fromRGB(0, 255, 0)
        end
    end
end)

-- Stats monitor (optional)
task.spawn(function()
    while task.wait(5) do
        if Stats.TotalSteals > 0 then
            local rate = math.floor((Stats.SuccessfulDups / Stats.TotalSteals) * 100)
            Components.AddLog(string.format(
                "Stats: %d success, %d failed (%d%% rate)",
                Stats.SuccessfulDups,
                Stats.FailedDups,
                rate
            ), "info")
        end
    end
end)

-- Global access
_G.BrainrotPanel = {
    Config = Config,
    Stats = Stats,
    GUI = GUI,
    Components = Components,
    Remotes = Remotes,
    GetAnimalData = GetAnimalData,
    GetAnimalList = GetAnimalList,
}

print("=================================")
print("üß† BRAINROT DUPLICATOR LOADED")
print("=================================")
print("Press F1 to toggle panel")
print("Press F2 for quick grab")
print("Press F3 to stop")
print("Press F4 for manual duplicate")
print("=================================")

return _G.BrainrotPanel
